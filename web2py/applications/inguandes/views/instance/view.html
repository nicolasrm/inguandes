{{extend 'layout.html'}}
<div class="row">
    <div class="span12">
        <h2>{{=inst.title}}</h2>
    </div>
</div>
<div class="row">
    <div class="span4">
        <div class="well" style="padding: 8px 0;">
            <ul class="nav nav-list">
                <li class="nav-header">Próximas Evaluaciones</li>
                {{ for t in u_tasks['pending']: }}
                    <li>
                        <i class="{{=t['icon']}}"></i>{{=t['name']}}
                        <span class="label label-success pull-right" rel="tooltip" title="Fecha de inicio">{{=t['starting'].strftime(datetime_format)}}</span>
                    </li> 
                {{ pass }}   
                <li class="divider"></li>                
                <li class="nav-header">Evaluaciones Activas</li>
                {{ for t in u_tasks['actived']: }}
                    <li>
                        <a href="{{=URL(t['type'], args=[t['id']])}}">
                            <i class="{{=t['icon']}}"></i>{{=t['name']}}
                            <span class="label label-warning pull-right" rel="tooltip" title="Fecha de cierre">{{=t['ending'].strftime(datetime_format)}}</span>
                        </a>
                    </li> 
                {{ pass }}
                {{ for t in u_tasks['ready']: }}
                    <li>
                        {{ if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe': }}
                        <a href="{{=URL(t['type'], args=[t['id']])}}">
                            <i class="{{=t['icon']}}"></i>{{=t['name']}}
                            <span class="label label-info pull-right" rel="tooltip" title="Fecha de cierre para ver los resultados.">{{=t['ending'].strftime(datetime_format)}}</span>
                        </a>
                        {{ else: }}
                        <span rel="tooltip" title="Este quiz ya lo finalizaste."><i class="{{=t['icon']}}"></i>{{=t['name']}}</span>
                        <span class="label label-info pull-right" rel="tooltip" title="Fecha de cierre para ver los resultados.">{{=t['ending'].strftime(datetime_format)}}</span>
                        {{ pass }}
                    </li> 
                {{ pass }}
                <li class="divider"></li>
                <li class="nav-header">Evaluaciones Cerradas</li>
                {{ for t in u_tasks['closed']: }}
                    <li>
                        <a href="{{=URL(t['type'], 'result', args=[t.id])}}">
                            <i class="{{=t['icon']}}"></i>{{=t['name']}}
                            <span class="label label-inverse pull-right" rel="tooltip" title="Fecha de cierre">{{=t['ending'].strftime(datetime_format)}}</span>
                        </a>
                    </li> 
                {{ pass }}                
                <li class="divider"></li>
            </ul>
            {{ if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe': }}
            <nav class="nav-menu">
                <ul>                                       
                    <li><a data-btn-type="new-quiz" data-toggle="modal" href="#modal-new-quiz" rel="tooltip" title="Agregar un quiz"><i class="icon-plus"></i><i class="icon-th-list"></i></a></li>
                    <li><a data-btn-type="new-task" data-toggle="modal" href="#modal-new-assignment" rel="tooltip" title="Agregar una entrega de trabajo"><i class="icon-plus"></i><i class="icon-upload"></i></a></li>
                </ul>
            </nav>
            {{ pass }}
        </div>
    </div>
    <div class="span8">    
        <div class="accordion" id="accordion_cgs">
        {{ 
        last_cg = ''
        for cg in c_groups: 
            if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe' or cg['id'] in contents: 
                accordion_group_id = 'collapse' + str(cg['id'])
                last_cg = accordion_group_id
        }}
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_cgs" href="#{{=accordion_group_id}}"><i class="icon-book"></i> {{=cg['title']}}</a>
                </div>
                <div id="{{=accordion_group_id}}" class="accordion-body in collapse" style="height: 0px; ">
                    <div class="accordion-inner">
                        <div class="row">
                            <div class="span3">
                                <ul class="nav nav-list">
                                    <li class="nav-header">Contenido Mínimo</li>
                                    {{  if cg['id'] in contents:
                                            for c in contents[cg['id']]['required']: 
                                                a_c = [I(_class='icon-' + c['icon']), c['name']]
                                                c['a_attrs']['_href'] = c['href']
                                                if c['description'] is not None and len(c['description']) > 0:
                                                    a_c.append(' ')
                                                    i_attr = {  '_class':'icon-info-sign',
                                                                '_rel':'popover',
                                                                '_title':c['name'],
                                                                '_data-content':c['description']}
                                                    a_c.append(I(**i_attr))
                                                pass
                                                response.write(LI(A(*a_c, **c['a_attrs'])))
                                            pass
                                        pass
                                    }}
                                </ul>
                            </div>
                            <div class="span3 offset1">
                                <ul class="nav nav-list">
                                    <li class="nav-header">Contenido Adicional</li>
                                    {{  if cg['id'] in contents:
                                            for c in contents[cg['id']]['optional']: 
                                                a_c = [I(_class='icon-' + c['icon']), c['name']]
                                                c['a_attrs']['_href'] = c['href']
                                                if c['description'] is not None and len(c['description']) > 0:
                                                    a_c.append(' ')
                                                    i_attr = {  '_class':'icon-info-sign',
                                                                '_rel':'popover',
                                                                '_title':c['name'],
                                                                '_data-content':c['description']}
                                                    a_c.append(I(**i_attr))
                                                pass
                                                response.write(LI(A(*a_c, **c['a_attrs'])))
                                            pass
                                        pass
                                    }}
                                </ul>
                            </div>
                        </div>
                        {{ if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe': }}
                        <div class="row accordion-admin-row">
                            <div class="span3">
                                <nav class="nav-menu">
                                    <ul>                                
                                        <li><a data-btn-type="new-content" data-new-content-type="file" data-cg-id="{{=cg['id']}}" href="#" rel="tooltip" title="Agregar un archivo"><i class="icon-plus"></i><i class="icon-file"></i></a></li>
                                        <li><a data-btn-type="new-content" data-new-content-type="video" data-cg-id="{{=cg['id']}}" href="#" rel="tooltip" title="Agregar un video"><i class="icon-plus"></i><i class="icon-facetime-video"></i></a></li>
                                        <li><a data-btn-type="new-content" data-new-content-type="link" data-cg-id="{{=cg['id']}}" href="#" rel="tooltip" title="Agregar un link"><i class="icon-plus"></i><i class="icon-bookmark"></i></a></li>
                                        <li><a data-btn-type="edit-content" data-cg-id="{{=cg['id']}}" href="#" rel="tooltip" title="Editar contenidos del grupo"><i class="icon-edit"></i></a></li>
                                    </ul>
                                </nav>                                
                            </div>
                            <div class="span3 offset1">
                                <nav class="nav-menu">
                                    <ul>
                                        <li><a data-btn-type="edit-content-group" data-cg-id="{{=cg['id']}}" data-cg-title="{{=cg['title']}}" href="#" rel="tooltip" title="Editar nombre grupo de contenidos"><i class="icon-edit"></i><i class="icon-book"></i></a></li>
                                        <li><a data-btn-type="remove-content-group" data-cg-id="{{=cg['id']}}" href="#" rel="tooltip" title="Eliminar grupo de contenidos"><i class="icon-remove"></i><i class="icon-book"></i></a></li>
                                    </ul>
                                </nav> 
                            </div>
                        </div>
                        {{ pass }}
                    </div>
                </div>
            </div>            
        {{  pass 
          pass
        }}
        </div>
    </div>
</div>
<!-- Navegation bar at bottom -->
<div class="navbar navbar-fixed-bottom">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            
            <div class="nav-collapse">
                <ul class="nav">
                    <li class="dropup">                        
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" rel="tooltip" title="Noticias"><i class="icon-bullhorn icon-white"></i> <b class="caret"></b></a>
                        <ul class="dropdown-menu">   
                            {{ for n in news: }}
                            <li>
                                <div class="label label-inverse">{{=n['created_on'].strftime(datetime_format)}}</div>
                                <a href="#" rel="popover" data-original-title="{{=n['title']}}" data-content="{{=n['content']}}">{{=n['title']}}</a>
                            </li>
                            {{ pass }}
                        </ul>
                    </li>
                    <!-- <li><a href="#" rel="tooltip" title="Foro"><i class="icon-comment icon-white"></i></a></li>
                    <li><a href="{{=URL('submit_ticket', args=[inst.id])}}" rel="tooltip" title="Emitir ticket"><i class="icon-plus icon-white"></i><i class="icon-tag icon-white"></i></a></li>-->
                    <li class="divider-vertical"></li>
                    {{ for il in inst_links: }}
                    <li><a href="{{=il['url']}}" target="_blank" rel="tooltip" title="{{=il['description']}}"><i class="icon-{{=il['icon']}} icon-white"></i></a></li>
                    {{ pass }}
                </ul>
            </div>
            {{ if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe': }}
            <!-- admin options -->
            <div class="nav-collapse">
                <ul class="nav pull-right">
                    <li class="divider-vertical"></li>
                    <li><a rel="tooltip" title="Agregar grupo de contenido" data-toggle="modal" href="#modal-new-contentgroup"><i class="icon-plus icon-white"></i><i class="icon-book icon-white"></i></a></li>
                    <li><a rel="tooltip" title="Agregar link de instancia" data-toggle="modal" href="#modal-new-permanent-link"><i class="icon-plus icon-white"></i><i class="icon-bookmark icon-white"></i></a></li>
                    <li><a rel="tooltip" title="Agregar noticia" data-toggle="modal" href="#modal-news"><i class="icon-plus icon-white"></i><i class="icon-bullhorn icon-white"></i></a></li>
                    <li><a href="{{=URL('groups', args=[inst.id])}}" rel="tooltip" title="Administrar grupos"><i class="icon-random icon-white"></i></a></li>
                    <li><a href="{{=URL('ticket_categories', args=[inst.id])}}" rel="tooltip" title="Administrar tickets"><i class="icon-user icon-white"></i><i class="icon-tags icon-white"></i></a></li>
                    <li><a href="{{=URL('view', args=[inst.id, 0])}}" target='_blank' rel="tooltip" title="Ver como estudiante"><i class="icon-eye-open icon-white"></i></a></li>
                </ul>
            </div>
            {{ pass }}
        </div>
    </div>
</div>

<!-- Video modal -->
<div class="modal hide fade in" id="modal-show-video" style="width: 600px; margin: -250px 0 0 -300px;">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3><span id="video-content-name"></span></h3>
    </div>
    <div class="modal-body">
        <iframe id="video-content-url" width="560" height="315" frameborder="0" allowfullscreen></iframe>
    </div>
</div>

{{ if user_roles[user_role] == 'Profesor' or user_roles[user_role] == 'Ayudante Jefe': }}
<!-- Instance admin modals -->
<div class="modal hide fade in" id="modal-new-contentgroup">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar grupo de contenidos</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_contentgroup')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="title">Título</label>
                    <div class="controls">
                        <input type="text" id="title" name="title"/>
                        <p class="help-block">Título que se desplegará para identificar el grupo de contenidos.</p>
                    </div>
                </div>
                
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Crear</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-edit-contentgroup">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Editar grupo de contenidos</h3>
    </div>
    <div class="modal-body">
        <form id="form-edit-contentgroup" class="form-horizontal" action="{{=URL('edit_contentgroup')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="title">Título</label>
                    <div class="controls">
                        <input type="text" id="edit-cg-title" name="title"/>
                        <p class="help-block">Título que se desplegará para identificar el grupo de contenidos.</p>
                    </div>
                </div>
                <input type="hidden" class="contentgroup-id" name="contentgroupid" />
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Editar</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-remove-contentgroup">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Eliminar grupo de contenidos</h3>
    </div>
    <div class="modal-body">
        <p>¿Está seguro que desea eliminar el grupo de contenidos <span id="delete-cg-title"></span>?
        <form id="form-remove-contentgroup" class="form-horizontal" action="{{=URL('remove_contentgroup')}}" method="POST">
            <fieldset>
                <input type="hidden" class="contentgroup-id" name="contentgroupid" />
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-danger modal-action">Eliminar</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-new-content-file">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar archivo</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_content')}}" method="POST" enctype="multipart/form-data">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="file-name">Nombre</label>
                    <div class="controls">
                        <input type="text" id="file-name" name="name"/>
                        <p class="help-block">Título que se desplegará para identificar el contenido.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="file-file">Archivo</label>
                    <div class="controls">
                        <input type="file" id="file-file" name="file"/>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="file-required">Requerido</label>
                    <div class="controls">
                        <label class="checkbox"><input type="checkbox" id="file-required" name="isrequired">indicar si el contenido se considera mínimo para el estudio.</label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="file-description">Descripción</label>
                    <div class="controls">
                        <textarea id="file-description" name="description"></textarea>
                    </div>
                </div>
                
                <input type="hidden" class="content-type" name="contenttype" value="file"/>
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
                <input type="hidden" class="content-group-id" name="cgid"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Agregar</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-new-content-video">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar video</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_content')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="video-name">Nombre</label>
                    <div class="controls">
                        <input type="text" id="video-name" name="name"/>
                        <p class="help-block">Título que se desplegará para identificar el contenido.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="video-url">URL</label>
                    <div class="controls">
                        <input type="text" id="video-url" name="url"/>
                        <p class="help-block">Dirección donde se encuentra publicado el video.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="video-required">Requerido</label>
                    <div class="controls">
                        <label class="checkbox"><input type="checkbox" id="video-required" name="isrequired">indicar si el contenido se considera mínimo para el estudio.</label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="video-description">Descripción</label>
                    <div class="controls">
                        <textarea id="video-description" name="description"></textarea>
                    </div>
                </div>
                
                <input type="hidden" class="content-type" name="contenttype" value="video"/>
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
                <input type="hidden" class="content-group-id" name="cgid"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Agregar</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-new-content-link">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar link</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_content')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="link-name">Nombre</label>
                    <div class="controls">
                        <input type="text" id="link-name" name="name"/>
                        <p class="help-block">Título que se desplegará para identificar el contenido.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="link-url">URL</label>
                    <div class="controls">
                        <input type="text" id="link-url" name="url"/>
                        <p class="help-block">Dirección del contenido al cual se quiere apuntar.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="link-required">Requerido</label>
                    <div class="controls">
                        <label class="checkbox"><input type="checkbox" id="link-required" name="isrequired">indicar si el contenido se considera mínimo para el estudio.</label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="link-description">Descripción</label>
                    <div class="controls">
                        <textarea id="link-description" name="description"></textarea>
                    </div>
                </div>
                
                <input type="hidden" class="content-type" name="contenttype" value="link"/>
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
                <input type="hidden" class="content-group-id" name="cgid"/>                
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Agregar</a>
    </div>
</div>

<div class="modal fade in" id="modal-edit-contents" style="width: 800px; margin: -250px 0 0 -400px; display: none;">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Editar contenido</h3>
    </div>
    <div class="modal-body">
        <div class="row">            
            <div class="span5">
                <div class="alert alert-block alert-error fade in" id="alert-renove-content">
                    <h4 class="alert-heading">Eliminar Contenido</h4>
                    <p>¿Está seguro que desea eliminar <strong><span id="content-to-remove"></span></strong>?</p>
                    <p><a class="btn btn-danger" id="alert-remove-content-confirm">Eliminar</a> <a class="btn" onclick="$('#alert-renove-content').fadeOut();" href="#">Cancelar</a></p>
                </div>
                <table class="table table-bordered table-condensed" id="table-edit-content">
                    <thead>
                        <tr>
                            <th>Contenido</th>
                            <th rel="tooltip" title="Se considera contenido mínimo?">R</th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="span4 hide" id="edit-content-form">                   
                <form class="form-vertical well" action="{{=URL('edit_content')}}" method="POST">
                    <fieldset>
                        <div class="control-group">
                            <label class="control-label" for="edit-content-name">Nombre</label>
                            <div class="controls">
                                <input type="text" id="edit-content-name" name="name"/>
                            </div>
                        </div>                        
                        <div class="control-group">                            
                            <div class="controls">
                                <label class="checkbox"><input type="checkbox" id="edit-content-required" name="isrequired">indicar si contenido se considera mínimo.</label>
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="edit-content-description">Descripción</label>
                            <div class="controls">
                                <textarea id="edit-content-description" name="description" placeholder="Texto que da detalles del contenido..."></textarea>
                            </div>
                        </div>
                        <div>
                            <button type="submit" class="btn btn-primary" id="button-edit-content">Guardar cambios</button>
                        </div>
                                                
                        <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
                    </fieldset>                    
                </form>
            </div>
        </div>
    </div>
</div>

<div class="hide">
    <table>
        <tr id="tr-edit-content-template">
            <td data-name></td>
            <td data-required></td>
            <td data-edit>
                <a class="btn btn-primary btn-small" rel="tooltip" title="Editar contenido" href="#" data-edit-content><i class="icon-edit icon-white"></i></a>
            </td>
            <td data-remove>
                <a class="btn btn-danger btn-small" rel="tooltip" title="Eliminar contenido" href="#" data-remove-content><i class="icon-remove icon-white"></i></a>
            </td>
        </tr>
    </table>
</div>

<div class="modal hide fade in" id="modal-new-quiz">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar nuevo quiz</h3>
    </div>
    <div class="modal-body">
        <div class="well">
            <form id="quiz-main-form" class="form-horizontal" action="{{=URL('quiz')}}" method="POST">
                <div class="control-group">
                    <label class="control-label" for="assignment-name">Nombre</label>
                    <input type="text" id="quiz-name" name="name" placeholder="Nombre del quiz"/>
                </div>
                <div class="control-group">
                    <label class="control-label" for="quiz-starting">Inicio</label>
                    <input type="datetime" class="input-small" id="quiz-starting" name="starting" placeholder="Inicio"/>
                </div>
                <div class="control-group">
                    <label class="control-label" for="quiz-ending">Fin</label>
                    <input type="datetime" class="input-small" id="quiz-ending" name="ending" placeholder="Fin"/>
                </div>                
                <input type="hidden" class="instance-id" id="quiz-instanceid" value="{{=inst.id}}"/>
            </form>
        </div>
        <div class="well">
            <form action="#" class="form-inline">
                <select id="quiz-category" placeholder="Categoría">
                {{ for cat in cats: }}
                        <option value="{{=cat}}">{{=cat}}</option>
                {{ pass}}
                </select>
                <input type="text" class="input-small" id="quiz-category-count" placeholder="# Preguntas"/>
                <a id="new-quiz-add-category" class="btn btn-success" href="#" rel="tooltip" title="Agregar categoria"><i class="icon-plus icon-white"></i></a>
            </form>
            <table class="table table-bordered" id="new-quiz-categories-table">
                <thead>
                    <tr>
                        <th style="width: 55%;">Categoría</th>
                        <th style="width: 30%;"># Preguntas</th>
                        <th style="width: 15%;">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary new-quiz-action">Crear</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-new-assignment">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar nuevo Trabajo</h3>
    </div>
    <div class="modal-body">        
            <form id="assign-main-form" class="form-horizontal" action="{{=URL('assignment')}}" method="POST" enctype="multipart/form-data">
                <div class="well">
                    <div class="control-group">
                        <label class="control-label" for="assignment-name">Nombre</label>
                        <input type="text" class="input-large" id="assignment-name" name="name" placeholder="Nombre del trabajo"/>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="assignment-starting">Inicio</label>
                        <input type="datetime" class="input" id="assignment-starting" name="starting" placeholder="Inicio"/>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="assignment-ending">Fin</label>
                        <input type="datetime" class="input" id="assignment-ending" name="ending" placeholder="Fin"/>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="assignment-file">Enunciado</label>
                        <div class="controls">
                            <input type="file" id="assignment-file" name="file"/>
                        </div>
                    </div>                    
                </div>                
                <div class="well form-inline">
                    <input type="text" class="input-large" id="assignment-file_types" name="file_types" placeholder="Tipo de archivos (ej: java;pdf)"/>
                    <select name="max_size">
                        <option value="" disabled="disabled" selected="selected">Tamaño máximo...</option>
                    {{ for (k,v) in file_size_options.iteritems(): }}
                        <option value='{{=k}}'>{{=v}}</option>
                    {{ pass }}
                    </select>
                    <label class="checkbox" id="assignment-multiple">
                        <input type="checkbox" name="multiple"> Más de un archivo
                    </label>
                </div>
                <div class="well form-inline">
                    <label class="checkbox" id="label-assignment-in_groups">
                        <input type="checkbox" name="in_groups" id="assignment-in_groups"> En grupos
                    </label>
                    <select class="disabled" name="group_list" id="assignment-group_list" disabled>
                        <option value="" disabled="disabled" selected="selected">Lista de grupos...</option>
                    {{ for gl in group_lists: }}
                        <option value="{{=gl['id']}}">{{=gl['name']}}</option>
                    {{ pass }}
                    </select>
                </div>
                <input type="hidden" class="instance-id" id="assignment-instanceid" name="instance" value="{{=inst.id}}"/>
            </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Crear</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-new-permanent-link">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar link permanente</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_permanent_link')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="inst-link-icon">Icono</label>
                    <div class="controls">
                        <span>
                            <select id="inst-link-icon" name="icon">
                                <option value="adjust">adjust</option>
                                <option value="asterisk">asterisk</option>
                                <option value="barcode">barcode</option>
                                <option value="bell">bell</option>
                                <option value="briefcase">briefcase</option>
                                <option value="calendar">calendar</option>
                                <option value="camera">camera</option>
                                <option value="cog">cog</option>
                                <option value="envelope">envelope</option>
                                <option value="fire">fire</option>
                                <option value="flag">flag</option>
                                <option value="gift">gift</option>
                                <option value="glass">glass</option>
                                <option value="globe">globe</option>
                                <option value="hdd">hdd</option>
                                <option value="headphones">headphones</option>
                                <option value="heart">heart</option>
                                <option value="leaf">leaf</option>
                                <option value="list-alt">list</option>
                                <option value="magnet">magnet</option>
                                <option value="music">music</option>
                                <option value="off">off</option>
                                <option value="picture">picture</option>
                                <option value="plane">plane</option>
                                <option value="print">print</option>
                                <option value="qrcode">qrcode</option>
                                <option value="search">search</option>
                                <option value="shopping-cart">shopping-cart</option>
                                <option value="signal">signal</option>                                
                                <option value="star">star</option>
                                <option value="thumbs-up">thumbs-up</option>
                                <option value="time">time</option>
                                <option value="tint">tint</option>
                            </select>
                            <i class="hide" id="link-show-icon"></i>
                        </span>
                        <p class="help-block">Ícono que identificará el link.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="inst-link-url">URL</label>
                    <div class="controls">
                        <input type="text" id="inst-link-url" name="url"/>
                        <p class="help-block">Dirección del contenido al cual se quiere apuntar.</p>
                    </div>
                </div>                
                <div class="control-group">
                    <label class="control-label" for="inst-link-description">Descripción</label>
                    <div class="controls">
                        <textarea id="inst-link-description" name="description" placeholder="Detalles del contenido del link..."></textarea>
                    </div>
                </div>
                                
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Agregar</a>
    </div>
</div>

<div class="modal hide fade in" id="modal-news">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">x</button>
        <h3>Agregar noticia</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="{{=URL('add_new')}}" method="POST">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="news-title">Título</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="news-title" name="title"/>
                        <p class="help-block">Título de la noticia.</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="news-content">Contenido</label>
                    <div class="controls">
                        <textarea class="input-xlarge" id="news-content" name="content"></textarea>
                        <p class="help-block">Contenido de la noticia.</p>
                    </div>
                </div>
                <div class="control-group">
                    <div class="controls">
                        <label class="checkbox" id="news-email">
                            <input type="checkbox" name="email" checked="checked"> Enviar por correo electrónio
                        </label>
                    </div>
                </div>                
                <input type="hidden" class="instance-id" name="instanceid" value="{{=inst.id}}"/>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Cerrar</a>
        <a href="#" class="btn btn-primary modal-action">Crear</a>
    </div>
</div>
{{ pass }}

{{block pagescripts}}
<script>
$(document).ready( function () {
    INGUANDES.last_cg = '{{=last_cg}}';
});
</script>
<script src="{{=URL('static', 'js/instance/view.js')}}"></script>
{{end}}



